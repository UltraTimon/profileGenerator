<!DOCTYPE html>
<html>

<head>
    <title>Profile Generator</title>
    <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>
</head>

<body>
    <div ng-app="myApp" ng-controller="myControl">
        <p>
            <label>First name:
                <input type="text" ng-model="firstName"> </label>
        </p>
        <p>
            <label>Second name:
                <input type="text" ng-model="lastName"> </label>
        </p>
        <p>
            <label>Birthday:
                <input type="date" ng-model="birthDate"> </label>
        </p>
        <p>
            <label>Shoe size:
                <input type="number" ng-model="shoeSize"> </label>
        </p>
        <p>
            <label>Favourite wizard (multiple answers are allowed):
                <label>
                    <input type="checkbox" ng-model="wizHarry"> Harry </label>
                <label>
                    <input type="checkbox" ng-model="wizRon"> Ron </label>
                <label>
                    <input type="checkbox" ng-model="wizHermoine"> Hermoine </label>
        </p>
        <p>
            <label>Favourite time of the day:
                <input type="time" ng-model="time"> </label>
        </p>
        <p>
            <label>Favourite color:
                <input type="color" id="colorPicker" ng-model="color"> </label>
        </p>

        <p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p>
        
        <!-- From here on the profile will be created real time-->

        <h2> {{ firstName }} {{ lastName }}</h2>
        <h4> Shoe size: {{ shoeSize }} </h4>
        <h4> Birthday: {{ birthDate | date: "yyyy-MM-dd" }} </h4>
        <h4> Favourite wizard(s): </h4>
        <ul>
            <li ng-show="wizHarry">Harry</li>
            <li ng-show="wizRon">Ron</li>
            <li ng-show="wizHermoine">Hermoine</li>
        </ul>
        <h4> favourite time of day: {{ time }} </h4>
        <h4> Favourite Color: {{ color }} </h4>
        <button ng-click="log()">Download the data!</button>
    </div>

    <script>
        angular.module('myApp', []).controller('myControl', function ($scope) {
            //Angular wasn't able to retrieve the colorpicker value, so I fixed it this way
            $scope.color = document.getElementById("colorPicker").value;
            //set the wizard values to their default values, false
            $scope.wizHarry = false;
            $scope.wizHermoine = false;
            $scope.wizRon = false;

            //This method turns the data that was entered into a json object,
            //which will be downloaded to the computer after generation
            $scope.log = function () {
                var person = {
                    firstName: $scope.firstName,
                    lastName: $scope.lastName,
                    birthDate: $scope.birthDate,
                    shoeSize: $scope.shoeSize,
                    //this is a list of booleans
                    wizards: {
                        "harry": $scope.wizHarry,
                        "ron": $scope.wizRon,
                        "hermoine": $scope.wizHermoine
                    },
                    time: $scope.time,
                    color: $scope.color
                }

                //here the JSON object will be downloaded as a .json file
                //thanks to DaniÃ«l Camps for providing the code.
                //source: https://stackoverflow.com/questions/19721439/download-json-object-as-a-file-from-browser
                var dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(person));
                var downloadAnchorNode = document.createElement('a');
                downloadAnchorNode.setAttribute("href", dataStr);
                downloadAnchorNode.setAttribute("download", "yourUniqueProfile.json");
                downloadAnchorNode.click();
                downloadAnchorNode.remove();
            }
        });
    </script>
</body>

</html>